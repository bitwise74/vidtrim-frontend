import{v as T,M as J,K as ee,m as L,aa as re,P as ae,Q as te,R as H,T as V,U as P,a0 as A,ai as ne,aj as se,W as U,Y as ie,w as oe,ak as z,al as B,V as le,a2 as ue,am as k,an as fe,Z as Y,_ as ce,ao as de,ap as F,aq as G,ar as ve,as as he,at as we,au as pe,av as _e,aw as me,a8 as ge,e as Ee,ax as be,ay as ye,a3 as Se}from"./Btcb0jqc.js";import{a as Te}from"./DDWaXS3i.js";import{l as Ie,w as D,g as De}from"./CkHgP2aA.js";import{g as $e}from"./CMM5F5IC.js";import{P as C}from"./DlTNSVnf.js";function Ue(r,a){return a}function qe(r,a,e){for(var t=r.items,s=[],o=a.length,l=0;l<o;l++)pe(a[l].e,s,!0);var c=o>0&&s.length===0&&e!==null;if(c){var v=e.parentNode;_e(v),v.append(e),t.clear(),S(r,a[0].prev,a[o-1].next)}me(s,()=>{for(var _=0;_<o;_++){var h=a[_];c||(t.delete(h.k),S(r,h.prev,h.next)),G(h.e,!c)}})}function je(r,a,e,t,s,o=null){var l=r,c={flags:a,items:new Map,first:null};T&&J();var v=null,_=!1,h=new Map,y=re(()=>{var i=e();return B(i)?i:i==null?[]:z(i)}),n,w;function u(){Ae(w,n,c,h,l,s,a,t,e),o!==null&&(n.length===0?v?Y(v):v=U(()=>o(l)):v!==null&&ce(v,()=>{v=null}))}ee(()=>{w??(w=ge),n=L(y);var i=n.length;if(_&&i===0)return;_=i===0;let p=!1;if(T){var $=ae(l)===te;$!==(i===0)&&(l=H(),V(l),P(!1),p=!0)}if(T){for(var g=null,f,d=0;d<i;d++){if(A.nodeType===ne&&A.data===se){l=A,p=!0,P(!1);break}var m=n[d],E=t(m,d);f=j(A,c,g,null,m,E,d,s,a,e),c.items.set(E,f),g=f}i>0&&V(H())}if(T)i===0&&o&&(v=U(()=>o(l)));else if(ie()){var x=new Set,I=oe;for(d=0;d<i;d+=1){m=n[d],E=t(m,d);var b=c.items.get(E)??h.get(E);b?K(b,m,d):(f=j(null,c,null,null,m,E,d,s,a,e,!0),h.set(E,f)),x.add(E)}for(const[M,q]of c.items)x.has(M)||I.skipped_effects.add(q.e);I.add_callback(u)}else u();p&&P(!0),L(y)}),T&&(l=A)}function Ae(r,a,e,t,s,o,l,c,v){var _=a.length,h=e.items,y=e.first,n=y,w,u=null,i=[],p=[],$,g,f,d;for(d=0;d<_;d+=1){if($=a[d],g=c($,d),f=h.get(g),f===void 0){var m=t.get(g);if(m!==void 0){t.delete(g),h.set(g,m);var E=u?u.next:n;S(e,u,m),S(e,m,E),O(m,E,s),u=m}else{var x=n?n.e.nodes_start:s;u=j(x,e,u,u===null?e.first:u.next,$,g,d,o,l,v)}h.set(g,u),i=[],p=[],n=u.next;continue}if(K(f,$,d),(f.e.f&F)!==0&&Y(f.e),f!==n){if(w!==void 0&&w.has(f)){if(i.length<p.length){var I=p[0],b;u=I.prev;var M=i[0],q=i[i.length-1];for(b=0;b<i.length;b+=1)O(i[b],I,s);for(b=0;b<p.length;b+=1)w.delete(p[b]);S(e,M.prev,q.next),S(e,u,M),S(e,q,I),n=I,u=q,d-=1,i=[],p=[]}else w.delete(f),O(f,n,s),S(e,f.prev,f.next),S(e,f,u===null?e.first:u.next),S(e,u,f),u=f;continue}for(i=[],p=[];n!==null&&n.k!==g;)(n.e.f&F)===0&&(w??(w=new Set)).add(n),p.push(n),n=n.next;if(n===null)continue;f=n}i.push(f),u=f,n=f.next}if(n!==null||w!==void 0){for(var N=w===void 0?[]:z(w);n!==null;)(n.e.f&F)===0&&N.push(n),n=n.next;var W=N.length;if(W>0){var X=null;qe(e,N,X)}}r.first=e.first&&e.first.e,r.last=u&&u.e;for(var Z of t.values())G(Z.e);t.clear()}function K(r,a,e,t){fe(r.v,a),r.i=e}function j(r,a,e,t,s,o,l,c,v,_,h){var y=(v&ve)!==0,n=(v&he)===0,w=y?n?ue(s,!1,!1):k(s):s,u=(v&de)===0?l:k(l),i={i:u,v:w,k:o,a:null,e:null,prev:e,next:t};try{if(r===null){var p=document.createDocumentFragment();p.append(r=le())}return i.e=U(()=>c(r,w,u,_),T),i.e.prev=e&&e.e,i.e.next=t&&t.e,e===null?h||(a.first=i):(e.next=i,e.e.next=i.e),t!==null&&(t.prev=i,t.e.prev=i.e),i}finally{}}function O(r,a,e){for(var t=r.next?r.next.e.nodes_start:e,s=a?a.e.nodes_start:e,o=r.e.nodes_start;o!==null&&o!==t;){var l=we(o);s.before(o),o=l}}function S(r,a,e){a===null?r.first=e:(a.next=e,a.e.next=e&&e.e),e!==null&&(e.prev=a,e.e.prev=a&&a.e)}function Le(r,a,e,t){var s=r.__style;if(T||s!==a){var o=Te(a);(!T||o!==r.getAttribute("style"))&&(o==null?r.removeAttribute("style"):r.style.cssText=o),r.__style=a}return t}function Q(r,a,e=!1){if(r.multiple){if(a==null)return;if(!B(a))return be();for(var t of r.options)t.selected=a.includes(R(t));return}for(t of r.options){var s=R(t);if(ye(s,a)){t.selected=!0;return}}(!e||a!==void 0)&&(r.selectedIndex=-1)}function Re(r){var a=new MutationObserver(()=>{Q(r,r.__value)});a.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Se(()=>{a.disconnect()})}function He(r,a,e=a){var t=!0;Ie(r,"change",s=>{var o=s?"[selected]":":checked",l;if(r.multiple)l=[].map.call(r.querySelectorAll(o),R);else{var c=r.querySelector(o)??r.querySelector("option:not([disabled])");l=c&&R(c)}e(l)}),Ee(()=>{var s=a();if(Q(r,s,t),t&&s===void 0){var o=r.querySelector(":checked");o!==null&&(s=R(o),e(s))}r.__value=s,t=!1}),Re(r)}function R(r){return"__value"in r?r.__value:r.value}const Ve=D(0),ke=D(0),ze=D(""),Be=D([]),Ye=D({}),xe=D(""),Me=D(0);async function Ge(r){const{file:a,trimStart:e,trimEnd:t,targetSize:s,processingSpeed:o}=r;if(!a)throw new Error("No file provided");const l=new FormData;l.append("file",a),e>0&&l.append("trimStart",`${e}`),t>0&&l.append("trimEnd",`${t}`),s>0&&l.append("targetSize",`${s}`),l.append("processingSpeed",`${o}`);const c=await fetch(`${C}/api/ffmpeg/start`,{method:"GET",credentials:"include"});if(c.status!=200){const n=await c.json();switch(c.status){case 401:throw new Error("Unauthorized");case 403:throw new Error("A job is already running. Please wait for it to finish");case 500:throw new Error(`Something went wrong while processing your request. Request ID: ${n.requestID} Error: ${n.error}`);default:throw new Error(n.error)}}const v=(await c.json()).jobID,_=new EventSource(`${C}/api/ffmpeg/progress?jobID=${v}`,{withCredentials:!0});_.onmessage=function(n){const w=parseFloat(n.data);w>=100&&_.close(),Me.set(w)};const h=await fetch(`${C}/api/ffmpeg/process?jobID=${v}`,{method:"POST",headers:{TurnstileToken:De(xe)},credentials:"include",body:l});if(h.status===200)return await h.blob();const y=await h.json();switch(h.status){case 400:throw new Error(y.error);case 401:throw new Error("Turnstile failed to verify that you're not a bot. Please refresh the page");case 413:throw new Error("File is too big");case 500:throw new Error(`Something went wrong while processing your request. Request ID: ${y.requestID} Error: ${y.error}`);default:throw new Error("Unknown error")}}async function Ke(r){const a=new FormData;a.append("file",r);const e=await fetch(`${C}/api/files`,{method:"POST",credentials:"include",body:a});if(e.status===200){$e("/dashboard");return}const t=await e.json();switch(e.status){case 400:throw new Error(t.error);case 413:throw new Error("File too large");case 500:throw new Error(`Something went wrong while processing your request. Request ID: ${t.requestID} Error: ${t.error}`)}}export{Ke as S,Ye as a,He as b,ze as c,ke as d,je as e,Ve as f,Ue as i,Me as j,Ge as p,Le as s,xe as t,Be as v};
